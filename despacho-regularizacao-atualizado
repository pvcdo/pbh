import pyautogui as p
import time
import datetime

import openpyxl

# wb = openpyxl.load_workbook("./admp28-12-2022-desde2016.xlsx")
# ws = wb['Planilha1']

Point = p.Point

lista_passos = [
"elemento inicial",
"elemento final",
"data mais atual",
"c. livres",
"data_1",
"data_2",
"rpps",
"executar",
"imprimir",
"aba principal"
]

contagem = 0

posicoes = [Point(x=199, y=445), Point(x=205, y=467), Point(x=211, y=541), Point(x=645, y=174), Point(x=283, y=377), Point(x=546, y=380), Point(x=285, y=407), Point(x=186, y=117), Point(x=239, y=118), Point(x=148, y=172)]

# posicoes = []

# print("Preparar para o mapeamento")

# for passo in lista_passos:
#     print(passo)
#     time.sleep(3)
#     posicao = p.position()
#     posicoes.append(posicao)

# print(posicoes)

# print("Pontos mapeados anteriormente, interrompa e mapeie novamente caso não faça sentido.")

lista_admissao = [
2019,
2019,
2017,
2018,
2019,
2017,
2020,
2020,
2017,
2017,
2020,
2019,
2020,
2017,
2020,
2020,
2020,
2019,
2020,
2020,
2020,
2020,
2018,
2019,
2018,
2020,
2019,
2020,
2020,
2017,
2019,
2019,
2018,
2018,
2019,
2018,
2019,
2019,
2018,
2020,
2020,
2018,
2019,
2017,
2020,
2020,
2018,
2019,
2019,
2020,
2020,
2020,
2018,
2018,
2019,
2018,
2020,
2018,
2019,
2019,
2018,
2017,
2019,
2018,
2018,
2019,
2018,
2019,
2020,
2019,
2017,
2017,
2020,
2020,
2017,
2018,
2017,
2019,
2020,
2019,
2017,
2017,
2018,
2020,
2020,
2020,
2018,
2019,
2017,
2021,
2020,
2020,
2020,
2019,
2021,
2020,
2019,
2020,
2018,
2020,
2017,
2020,
2019,
2020,
2018,
2019,
2018,
2016,
2019,
2018,
2020,
2020,
2018,
2020,
2020,
2021,
2019,
2017,
2021,
2019,
2020,
2018,
2018,
2020,
2021,
2019,
2017,
2018,
2020,
2019,
2019,
2019,
2019,
2018,
2020,
2021,
2021,
2021,
2019,
2020,
2019,
2020,
2020,
2020,
2016,
2018,
2020,
2020,
2020,
2018,
2018,
2018,
2020,
2019,
2021,
2021,
2018,
2019,
2017,
2019,
2020,
2019,
2020,
2020,
2018,
2020,
2020,
2019,
2018,
2019,
2019,
2017,
2018,
2021,
2019,
2020,
2019,
2019,
2020,
2020,
2019,
2020,
2017,
2020,
2018,
2019,
2020,
2019,
2016,
2020,
2020,
2020,
2020,
2018,
2019,
2019,
2019,
2019,
2020,
2020,
2019,
2019,
2018,
2016,
2020,
2020,
2020,
2019,
2021,
2021,
2019,
2019,
2020,
2020,
2019,
2019,
2019,
2020,
2020,
2018,
2020,
2019,
2018,
2019,
2020,
2019,
2021,
2018,
2021,
2019,
2020,
2017,
2019,
2019,
2017,
2017,
2019,
2021,
2020,
]
lista_rescisao = [
2021,
2020,
2020,
2020,
2020,
2020,
2020,
2020,
2021,
2020,
2020,
2020,
2020,
2020,
2022,
2020,
2020,
2020,
2021,
2020,
2021,
2020,
2020,
2021,
2021,
2020,
2021,
2021,
2021,
2020,
2021,
2020,
2020,
2019,
2021,
2020,
2020,
2021,
2020,
2020,
2020,
2019,
2019,
2019,
2020,
2020,
2020,
2020,
2020,
2021,
2021,
2020,
2020,
2020,
2020,
2019,
2020,
2019,
2021,
2021,
2020,
2018,
2020,
2020,
2019,
2021,
2020,
2020,
2021,
2020,
2019,
2020,
2020,
2020,
2019,
2019,
2021,
2019,
2020,
2020,
2020,
2020,
2020,
2021,
2020,
2021,
2020,
2020,
2019,
2021,
2021,
2020,
2020,
2020,
2021,
2021,
2020,
2020,
2020,
2020,
2019,
2020,
2019,
2021,
2021,
2020,
2020,
2019,
2019,
2020,
2020,
2020,
2021,
2020,
2021,
2022,
2021,
2020,
2021,
2020,
2021,
2021,
2019,
2020,
2021,
2020,
2017,
2020,
2021,
2020,
2020,
2020,
2020,
2021,
2021,
2022,
2022,
2021,
2020,
2021,
2020,
2020,
2020,
2020,
2020,
2020,
2020,
2020,
2020,
2020,
2020,
2020,
2021,
2019,
2021,
2022,
2019,
2019,
2020,
2019,
2020,
2020,
2020,
2021,
2020,
2021,
2020,
2021,
2019,
2020,
2021,
2020,
2019,
2021,
2020,
2021,
2021,
2019,
2020,
2020,
2020,
2020,
2020,
2021,
2019,
2020,
2020,
2019,
2020,
2021,
2020,
2020,
2021,
2020,
2021,
2020,
2021,
2020,
2021,
2021,
2021,
2019,
2020,
2020,
2020,
2021,
2020,
2021,
2021,
2021,
2020,
2021,
2020,
2020,
2020,
2020,
2019,
2020,
2021,
2020,
2020,
2020,
2020,
2021,
2020,
2019,
2022,
2019,
2021,
2021,
2021,
2020,
2020,
2020,
2020,
2018,
2019,
2021,
2020,
]
lista_matriculas = [
"1208142",
"0586043",
"0581434",
"0584702",
"1208142",
"0582477",
"1228607",
"1230954",
"0582137",
"0582067",
"1229026",
"0587717",
"1240275",
"0582065",
"1211348",
"1246273",
"1231284",
"0586176",
"1243878",
"122797X",
"1238300",
"123321X",
"0584508",
"1193021",
"0585442",
"1223370",
"0585858",
"1217206",
"1228399",
"0581918",
"1197833",
"1191223",
"0583993",
"0583803",
"1192726",
"0583014",
"0586582",
"1197272",
"0582684",
"1243215",
"1232183",
"0585557",
"0585888",
"0582359",
"122749X",
"1218350",
"0585513",
"1203299",
"0585817",
"1231543",
"122914X",
"1217257",
"0584323",
"0585514",
"0587200",
"0583068",
"1218431",
"0584569",
"0587344",
"1201873",
"0584901",
"0580451",
"1188168",
"0585566",
"0583564",
"1204236",
"0583908",
"0587320",
"1211682",
"0585580",
"0581234",
"0582372",
"1217621",
"1229506",
"0580858",
"0585021",
"0582041",
"0586659",
"1224040",
"0585767",
"0582161",
"0582132",
"0584255",
"1235344",
"1226213",
"1246567",
"0583814",
"1190340",
"0580748",
"1271081",
"1235204",
"123559X",
"1231829",
"1192424",
"1270409",
"1209475",
"0587289",
"1239110",
"0584562",
"1226159",
"0579852",
"1211836",
"0803791",
"1232892",
"0582700",
"0586040",
"0582586",
"0579666",
"1197140",
"0584239",
"122346X",
"123061X",
"0582792",
"1227589",
"1233392",
"1277381",
"0586042",
"0582416",
"1267076",
"1192289",
"1211321",
"0585118",
"0584383",
"1219101",
"126901X",
"0585819",
"0580491",
"0584675",
"123075X",
"0585954",
"0587326",
"0587456",
"0587503",
"0585167",
"1220584",
"1269583",
"126753X",
"1289827",
"0587384",
"1216005",
"1190820",
"122086X",
"1214010",
"1230733",
"0579818",
"0582666",
"1228844",
"1244653",
"1233341",
"0582630",
"0584319",
"0584307",
"1230660",
"0586372",
"128616X",
"1282032",
"0584905",
"1196446",
"0582348",
"0587373",
"1216900",
"1189776",
"1242111",
"1235581",
"0584422",
"1209807",
"1233015",
"0586816",
"0584736",
"0587152",
"0586618",
"0582169",
"0584962",
"127742X",
"120743X",
"1236324",
"0585887",
"0586610",
"121844X",
"1218660",
"1187765",
"1215297",
"0581912",
"1228542",
"0583197",
"0587160",
"1211496",
"0586666",
"0579744",
"1223656",
"1221122",
"1216838",
"1223753",
"0585221",
"0587262",
"0587882",
"1189652",
"0587631",
"1245838",
"123660X",
"0585660",
"0587307",
"0584751",
"0579740",
"1224172",
"123707X",
"1227279",
"1188648",
"1285953",
"1310303",
"1191878",
"0586246",
"1243126",
"1228763",
"0586144",
"0587389",
"0586698",
"1223567",
"1222455",
"0585251",
"1218172",
"1193153",
"0584654",
"0585951",
"1219012",
"0587101",
"128082X",
"0583692",
"1287271",
"0586375",
"1244459",
"0581419",
"0587191",
"0585773",
"0582229",
"0580602",
"1195598",
"1298516",
"1211194",
]
lista_nomes = [
"EDILENE APARECIDA SOARES DA COSTA",
"ANNA TERESA MOREIRA NEVES",
"DANIELLE ESTEVES DE MOURA",
"FRANCISCO DE ASSIS NASCIMENTO CASTRO",
"FLAVIA FABIANNE DE BRITO E FREITAS",
"DENISE DE OLIVEIRA RODRIGUES",
"DEBORA ROCHA DOS SANTOS",
"CINDY BOTELHO DOS SANTOS",
"AMANDA BARALDI DE SOUZA ARAUJO",
"CLAUDIO EMIDIO DOS SANTOS",
"ANA CAROLINA ANDRADE DA CRUZ",
"ALEXANDRE SANTOS RIBEIRO ",
"ANA CLAUDIA AUXILIADORA LIMA FONSECA",
"ANA PAULA ARAUJO DE CASTRO",
"ALEXANDRE DALVES DAMASCENO",
"MARIA DE FATIMA BARROS CARDOSO",
"WILSON DOS SANTOS MORAIS",
"VANILSA CONCEICAO DE OLIVEIRA BONFIM",
"TATIANA JESUS DO AMARAL MARTINS",
"SOLANGE DA SILVA CARDOSO MOREIRA",
"SUELI DE FATIMA DE OLIVEIRA SILVA",
"RAQUEL VITORIO OLIVEIRA",
"ROSIMARY BORGES FERREIRA",
"PAULA LORRAINE FERNANDES DE SOUZA",
"MOEMA GUIMARAES MOURA",
"MARLI QUARESMA SILVA",
"MARINA XAVIER DE MIRANDA POMPEU",
"MARCELO FELIX DA SILVA",
"ANA CAROLINA NUNES",
"ANA CAROLINA MARTINS DE OLIVEIRA",
"DJESSYKA EMANUELLY SANTOS VASCONCELOS TEIXEIRA",
"ELIANA FAUSTA SANTANA",
"EVILSON PIO DA SILVA",
"ELIZABETH FERNANDES SILVA DOS SANTOS",
"DIANA VIEIRA AMARANTE PIMENTA",
"DAYANNE CRISTINA DE DEUS ALVES",
"DANIELA ALVES MOREIRA",
"CRISTIANE DINIZ FAGUNDES",
"CRISTIANE DA MATA SARSUR MACHADO",
"CRISTIANE PADILHA DE MIRANDA",
"CAROLINA BRETAS ARAUJO",
"BRUNA LUIZA DE MELO",
"ANA RAQUEL CASTRO PELLOZO PALLOS",
"ADRIANA SANTOS DE MIRANDA",
"ANA LUISA TOLENTINO SANTOS",
"ALEYKSON ANDREI PESSOA DA SILVEIRA",
"ANDREIA MOREIRA LIMA",
"JULIANA BARONY DA SILVA",
"LARISSA CAMPOS LEITE IANINO",
"MARIANA FARIA AMARAL",
"MARCIA APARECIDA SILVA",
"MARCIA NIEDERBERGER DOS SANTOS",
"MARILENE APARECIDA PINTO",
"LARISSA RIBEIRO DA SILVEIRA",
"JOSIANE SILVA FAGUNDES",
"JESSICA GRAZIELLE ALVES LIMA",
"JOSEANA ALEXANDRE QUINTO",
"JOSE JORGE FREITAS",
"JOYCE ARMANY QUEIROZ SILVEIRA",
"JORDANIA DARC FIGUEIREDO DA SILVA",
"JULIANA ALVES DA SILVA",
"HULIE MARTINS FERREIRA",
"GRAZIELLE BARBOSA",
"MARIA DA LUZ BATISTA FORNERIS",
"MARIA MARGARIDA BARBOSA",
"MARIA APARECIDA DINIZ",
"MARIZA CRISTINA GONCALVES DE SALES",
"MARCO AURELIO GONTIJO OLIVEIRA",
"NATHALIA MARIA RAMOS SANTOS",
"NATALIA VASCONCELOS SILVA",
"NATALIA MARTINS BERNARDES",
"NATALIA APARECIDA CARNEIRO",
"PAULA FIGUEIREDO OLIVEIRA",
"PATRICK LOPES DIAS",
"PRISCILLA GERMANA DA SILVA MAGALHAES PEREIRA",
"PATRICIA FERNANDA DE MELO",
"PAULA NADIELLY TEIXEIRA DOS SANTOS",
"MARILIA DE JESUS",
"REGIANA BUTZLAFF",
"RAUL MARCOS DOS SANTOS AMARAL",
"TAISE DE ALMEIDA COELHO",
"VANIZETE GERMANO DOS SANTOS",
"WILMA ALVES DE FREITAS",
"ROBERTA PEREIRA DE MIRANDA FRANCO",
"SANDRA MENDES DOS REIS",
"WANDER LEONARDO SANTANA",
"ALINE RAFAELA DE SOUZA CARDOSO",
"ADRIANA COSTA DOURADO",
"BRENDA CECILIA DE OLIVEIRA MARGARIDO",
"BRENO CRISTIAN SOARES",
"BRUNA MARTINS NOGUEIRA DA GAMA",
"BRUNA NEGRAO FERREIRA",
"ANELEH ABDANUR NASSAR",
"BRUNA CAROLINA CAVALCANTI MARQUES",
"ANA CLARA ANDRADE NORONHA SANTOS",
"ANA CAROLINA ALVES VAZ DE MELO",
"AURELIO LEITE RANGEL SOUZA HENRIQUES",
"ANA ZILDA MARTINS DA SILVA ",
"ALICE SOUSA RUAS",
"ALCIONE CRISTINA FERNANDES",
"ALESSANDRA SERIO MACHADO",
"ALINE GARCIA JORGE DOS SANTOS",
"AMANDA CAROLINA DINIZ PORTO",
"ANDRESSA VALERIO ROCHA",
"BARBARA MICHELLE LEMOS LIMA COSTA",
"ARIANA BRANDAO DE OLIVEIRA FERNANDES",
"DIEGO MORENO DE SOUZA EVANGELISTA",
"DANIEL LEITE BARRETO",
"DEBORAH DYOVANA DE SOUZA MARCAL",
"CARINA CARLA ALVES DA SILVA",
"CAROLINE EUGENIA CARDOSO",
"DEBY YURI DA SILVA COELHO",
"CARLA SAYURI FOGACA OIKO",
"DAISY MARIA BAETA COSTA",
"CARLOS ROBERTO MENDES",
"CELIA DA SILVA CARDOSO LIMA",
"CASSIA JULIANA DOS REIS",
"CLAUDIA CRISTINA VIANA DOS SANTOS",
"CARLOS ROBERTO MENDES",
"DANIELY FERNANDA DE SOUZA",
"CLEUBER COELHO DUARTE",
"DANIEL RUSH SILVA",
"DANIEL FRANCISCO DE ARAUJO",
"DRIELI LANA MORAIS LEAL",
"DALTON DUARTE DE LIMA JUNIOR",
"CAMILA FERREIRA DE REZENDE",
"CLAUDINAR PEREIRA LEITE",
"CLEUDY SILVA MORAIS",
"CRISTINA DE ALMEIDA CRUZ",
"JAQUELINE AMORIM ARANTES GOMES",
"LAURA DE MELLO ANDRADE",
"LUISA CAROLINA TEROZENDI ABREU",
"LEIDY PAOLA CASAS GRAJALES",
"LILIAN SILVA VIEIRA",
"LORENA APARECIDA DE SOUZA CASTRO",
"LUCIANA CRISTINA DE SENA",
"LUDMILA GONCALVES RIOS",
"LADY DE PAULA SANTOS BRAGA",
"LUANA SAMPAIO DA SILVA",
"KELLEN SIMONE MENDES",
"KISSILA MAEONE FERREIRA CRISPIM",
"KEETURY PARREIRAS MARTINS",
"JANAINA JOSE CORREA DE CASTRO",
"JULIANA COSTA SILVA FREIRE",
"JOSIANE DA COSTA SOARES",
"JACQUELINE RUBIA DE SOUZA PAIVA DA SILVA",
"JESSICA LEMES DOS SANTOS",
"JANAINE STELITA RIBEIRO",
"DANIELA JESSICA PEREIRA",
"ANA PAULA DA SILVA",
"BRUNA ELIANE DA SILVA",
"ALEXANDRE NEVES FURTADO",
"ELIZA MARIA VILACA DE AZEVEDO",
"EDUARDO GOMES CAMPANATI",
"ENDIE ARAUJO DE OLIVEIRA",
"FIAMA DO CARMO SILVA ALCANTARA",
"EBERTE MONTEIRO DA SILVA",
"EDER JULIO ROCHA DE ALMEIDA",
"DANIELE FERNANDA HELENO PEREIRA CAIRES",
"DEBORA LUIZA XAVIER VIEIRA",
"DOUGLAS RODRIGUES DA SILVA",
"DOUGLAS HENRIQUE DE OLIVEIRA DE ARAUJO",
"DANIELA ALVES DE BRITO QUEIROZ",
"CARLOS VINICIUS MOREIRA SALGADO",
"CARLA NIVIA MORAN FERNANDES",
"CARLA TAMIRES DOS SANTOS TEODORO",
"ANNA RAQUEL GOMES DA SILVA",
"ADRIANA CARMO DA SILVA",
"ALDA APARECIDA MOTA",
"AUGUSTO DA COSTA MATOSO NETO",
"ALINE FERREIRA DOS SANTOS",
"ANDREIA ROSARIA ASSUNCAO",
"ANDREA RODRIGUES ANJOS DE SOUZA",
"ANDREA LISBOA BARBOSA",
"ANA FLAVIA ALMEIDA",
"ALINE EMANUELE FERREIRA OLIVEIRA",
"ANGELA MARIA ELIAS",
"ANA FLAVIA MOURA MARTINS",
"ANA FERNANDA DOS SANTOS SOUZA",
"ALESSANDRA PEREIRA FELIX",
"ALENCAR SILVA NETTO",
"ANA LUIZA ALVES DO AMARAL BERTELLI",
"BERNARDO BARROS ANDRADE E SILVA",
"BEATRIZ VIEIRA COELHO",
"BRENO TEIXEIRA MORENO",
"BRUNA RAFAELA BESSA FERRAZ",
"CINARA FERREIRA VIANA MOTA",
"JULIANA PINHEIRO BALDEZ",
"JOAO CARLOS FAGUNDES DE SOUZA ",
"JOYCE RODRIGUES DOS SANTOS",
"JULIANA MANDARANO DE MATTOS",
"JOAO HENRIQUE BRANDAO SANTOS",
"JOSIANE DIAS ALVES",
"JESSICA RODRIGUES ALVARENGA",
"JENNIFER DOS SANTOS SILVA",
"JANDIRA DUTRA PADILHA",
"JESSICA DE OLIVEIRA MELO",
"KESSIA DANIELLE PINHEIRO BUENO",
"KATIA DE OLIVEIRA LEITE ANACLETO ANTAO",
"LUIZ FERNANDO DE OLIVEIRA SANTANA",
"KELLY VIEIRA PRATES",
"LAURA DE MELO BONFIM",
"LUCAS PIMENTA MOTA",
"LUANA DA CUNHA TAVARES AMARAL",
"LILIANE MARCIA DE SOUZA SILVA",
"LARISSA CRISTINE COSTA NOVAIS FORTES",
"LIEGE LYRA DE PAULA",
"LUCELIA PAULA GOMES",
"LUCAS MAIA BERALDO",
"LUIZA CARNEIRO LIMA",
"FAUSTO JOSE SOLIS CARVALHO",
"LIZANGELA FERRAZ DO NASCIMENTO",
"FABIANO SIQUEIRA",
"FELIPE CAMPOS DA SILVA",
"FERNANDA VIDAL",
"FABIANA LIMA PESSOA DE MENDONCA",
"FERNANDA VILACA MARTINS",
"FABIANA PAULA BUENO DA SILVA",
"GEISYANE FERREIRA DA SILVA DINIZ FREITAS",
"GUSTAVO MAGALHAES COIMBRA",
"GUILHERME ENDRIGO FERNANDES",
"GRACIELLE MARIA DA PENHA BRAGA",
"HENRIQUE YANKOUS CICARINI",
"ISABELLA CRISTINA DO CARMO",
"ISABELA CRISTINA DOS SANTOS MILITAO",
"JULIA MARIA SIMAO DA ROCHA",
"JAIME ENRIQUE DURAN BUSTAMANTE",
"JOYCE GRAZIELLE ALVES LIMA",
"JULIANA DE SOUZA LIMA COUTINHO",
"JANICE RAFAELA NUNES VIEIRA",
"LIEGE LYRA DE PAULA",
"LUCELIA RODRIGUES MARQUES ROCHA",
"LUCIANA DE MATTOS CARNEIRO GONZAGA",
"LAIS CHAVES DE SOUZA",
"LUCIANE ALVES DA SILVA SANTOS",
"LIVIA LUISA KAHEY ALVES DE OLIVEIRA",
"LILIANE CAROLINA DA SILVA",
"LUCIANA OLIVEIRA ROCHA",
"LUDMILLA ZAGO ANDRADE",
]

def executarEsperar(fazer,tempo=1):
  fazer
  time.sleep(tempo)

executarEsperar(print("Cliquie no elemento final"),5)

now = datetime.datetime.now()
print(str(now.hour)+":"+str(now.minute)+":"+str(now.second))

iniciar_em = 148

for i in range(iniciar_em, 238):
  admissao = lista_admissao[i]
  rescisao = lista_rescisao[i]
  matricula = lista_matriculas[i]
  nome = lista_nomes[i]

  print("Pessoa "+str(i+1))
  ano_variavel = admissao
  p.click(posicoes[0])
  p.write(matricula) #escrever matricula
  p.click(posicoes[1])
  p.write(matricula)#escrever matricula
  p.click(posicoes[2])
  while ano_variavel <= rescisao:
    p.click(posicoes[3])
    p.click(posicoes[4])
    p.write("0101"+str(ano_variavel))#escrever data 01/01/{ano variável}
    p.click(posicoes[5])
    p.write("3112"+str(ano_variavel))#escrever data 31/12/{ano variável}
    p.click(posicoes[6]) #rpps
    executarEsperar(p.click(posicoes[7])) #executar
    executarEsperar(p.press("enter")) #ok
    executarEsperar(p.click(posicoes[8]),2)#imprimir
    executarEsperar(p.press("enter"),2) #pressionar enter
    executarEsperar(p.write("FF-"+matricula+"-"+nome+"-"+"-"+str(ano_variavel)))#escrever como nome do arquivo "DS-{nome do profissional}-{matricula}"
    executarEsperar(p.press("enter"),3)#pressionar enter

    ano_variavel += 1
    contagem += 1
    print(contagem)
    now = datetime.datetime.now()
    print(str(now.hour)+":"+str(now.minute)+":"+str(now.second))
    
  executarEsperar(p.click(posicoes[9]))
